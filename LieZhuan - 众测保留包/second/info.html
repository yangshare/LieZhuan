<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>猎赚</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<link rel="stylesheet" href="../css/mui.css">
		<link rel="stylesheet" type="text/css" href="../css/iconfont.css" />
		<style>
				.mui-content {
				margin: 0px 10px;
				margin-top: 30px;
			}
			
			.mui-icon {
				color: white;
			}
			
			.mui-title {
				font-family: "微软雅黑";
				font-weight: bold;
			}
			
			.reg-img {
				text-align: center;
			}
			
			.reg-img img {
				border-radius: 50px;
			}
			
			.mui-grid-view.mui-grid-9 .mui-col-xs-4 {
				margin: 0;
				padding: 11px 15px;
				vertical-align: middle;
				border-right: 0px;
				border-bottom: 0px;
			}
			
			.mui-table-view.mui-grid-view .mui-col-xs-4 .mui-media-body {
				color: white;
				margin-bottom: 5px;
				font-family: "幼圆";
				white-space: nowrap;
				overflow: visible;
			}
			
			.mui-table-view.mui-grid-view .mui-col-xs-4 span {
				color: white;
				font-family: "微软雅黑";
				font-size: 12px;
			}
			
			.mui-col-xs-6 .mui-icon {
				color: #333;
			}
			
			.mui-grid-view.mui-grid-9 .mui-col-xs-6 {
				border-right: 1px solid #B1B1B1;
				border-bottom: 1px solid #B1B1B1;
			}
			
			.mui-table-view.mui-grid-view .mui-col-xs-6 .mui-media-body {
				font-size: 12px;
			}
			
			.mui-grid-view.mui-grid-9 {
				border-top: 1px solid #eee;
				border-left: 1px solid #eee;
				border-right: 1px solid #eee;
				border-bottom: 1px solid #eee;
				border-radius: 12px;
		</style>
	</head>

	<body style="background-color: #4FD2C2;">
		<header class="mui-bar mui-bar-nav">
			<a class=" mui-icon mui-icon-back mui-pull-left" style="color: white;"></a>
			<h1 class="mui-title">个人中心</h1>
		</header>
		<div class="mui-content" style="background-color: #4FD2C2;">
			<div style="background-color: #4FD2C2;">
				<div class="reg-img" style="background-color: #4FD2C2;">
					<img src="../image/header.jpg" width="100px" height="100px" />
				</div>
				<!--END头像-->
				<div id="nickname" style="text-align: center;margin-top: 10px;color: white;">
					昵称昵称
				</div>
				<div style="margin:auto;margin-top: 10px;width: 70%;color: white;">
					<p id="useSign" style="color: white;">能和心爱的人一起睡觉，是件幸福的事情；可是，打呼噜怎么办？</p>
					<ul class="mui-table-view mui-grid-view mui-grid-9" style="background-color: #4FD2C2;border: 0px;">
						<li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
							<div>
								<div class="mui-media-body">关注</div>
								<span id="look">0</span>

							</div>
						</li>
						<li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
							<div>
								<span class="mui-media-body mui-icon iconfont icon-dianzan" style="font-size: 20px;"></span>
								<span id="good">0</span>

							</div>
						</li>
						<li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
							<div>
								<div class="mui-media-body">粉丝</div>
								<span id="fans">0</span>

							</div>
						</li>
					</ul>
				</div>

			</div>

			<div style="margin:0px -10px;background-color: white;padding: 20px;">
				<ul id="myGrid-9" class="mui-table-view mui-grid-view mui-grid-9" style="background-color: #F8F8F9;">
					<li class="mui-table-view-cell mui-media mui-col-xs-6 mui-col-sm-6">
						<a href="info/myTaskPush.html">

							<span class="mui-icon iconfont icon-gerenfabu"></span>
							<div class="mui-media-body">个人发布</div>

						</a>
					</li>
					<li class="mui-table-view-cell mui-media mui-col-xs-6 mui-col-sm-6" style="border-right:0px;">
						<a href="info/myInfo.html">

							<span class="mui-icon iconfont icon-gerenziliao"></span>
							<div class="mui-media-body">个人资料</div>

						</a>
					</li>
					<li class="mui-table-view-cell mui-media mui-col-xs-6 mui-col-sm-6">
						<a href="info/ability.html">

							<span class="mui-icon iconfont icon-nenglizhi"></span>
							<div class="mui-media-body">能力值</div>

						</a>
					</li>
					<li class="mui-table-view-cell mui-media mui-col-xs-6 mui-col-sm-6" style="border-right:0px;">
						<a href="info/myMoney.html">

							<span class="mui-icon iconfont icon-shangjinkoudai"></span>
							<div class="mui-media-body">赏金口袋</div>

						</a>
					</li>
					<!--下面两个-->
					<li class="mui-table-view-cell mui-media mui-col-xs-6 mui-col-sm-6" style="border-bottom:0px;">
						<a href="info/setting.html">
						<!--<a id="setting" href="javascript:void(0);">-->
							<span class="mui-icon iconfont icon-shezhi"></span>
							<div class="mui-media-body">设置</div>

						</a>
					</li>
					<li class="mui-table-view-cell mui-media mui-col-xs-6 mui-col-sm-6" style="border-bottom:0px;border-right:0px;">
						<a href="#">

							<span class="mui-icon iconfont icon-jianchagengxin"></span>
							<div class="mui-media-body">更新</div>

						</a>
					</li>

				</ul>
				<br />
				<button id="cancel" class="mui-btn-block" style="border-radius:12px ;font-size: 12px;background-color: #F8F8F9;">注销登录</button>
			</div>

		</div>
		<script src="../js/mui.min.js"></script>
		<script src="../js/my/variable.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			mui.init({
				swipeBack: false

			});
			mui.plusReady(function() {
				//返回键，退出应用
				var backButtonPress = 0;
				mui.back = function(event) {
					goback();
				};
				mui(".mui-icon-back")[0].addEventListener("tap", function() {
					goback();
				});

				function goback() {
					if(mui.os.ios) {
						mui.toast("请按home键退出");
					} else {
						backButtonPress++;
						if(backButtonPress > 1) {
							//调用后台注销
							var wt = null;
							mui.ajax(myUrl + 'Hunter/User_quit.action', {
								data: {},
								dataType: 'json', //服务器返回json格式数据
								type: 'post', //HTTP请求类型
								timeout: 10000, //超时时间设置为10秒；
								beforeSend: function() {
									wt = plus.nativeUI.showWaiting();
								},
								success: function(data) {
									console.log("注销登录");
									//关闭加载动画
									wt.close();
								},
								error: function(xhr, type, errorThrown) {
									//关闭加载动画
									wt.close();
								}
							});
							plus.runtime.quit();
						} else {

							plus.nativeUI.toast('再按一次退出应用');
						}
						setTimeout(function() {
							backButtonPress = 0;
						}, 1000);
						return false;
					}

				}
				mui("#cancel")[0].addEventListener("tap", function() {
					//调用后台注销
					var wt = null;
					mui.ajax(myUrl + 'Hunter/User_quit.action', {
						data: {},
						dataType: 'json', //服务器返回json格式数据
						type: 'post', //HTTP请求类型
						timeout: 10000, //超时时间设置为10秒；
						beforeSend: function() {
							wt = plus.nativeUI.showWaiting();
						},
						success: function(data) {

							//关闭加载动画
							wt.close();
							plus.webview.open("../login.html"); // 显示窗口
							//打开新页面关闭当前页面栈webview
							var wss = plus.webview.all();
							for(var i = 0; i < wss.length; i++) {
								plus.webview.close(wss[i]);

							}
						},
						error: function(xhr, type, errorThrown) {
							//关闭加载动画
							wt.close();
							plus.nativeUI.toast("网络异常");
						}
					});

				});

				/*
				 * 获取用户信息
				 */

				var infoWt = null;
				mui.ajax(myUrl + 'Hunter/User_giveCurrentUser.action', {
					data: {},
					dataType: 'json', //服务器返回json格式数据
					type: 'post', //HTTP请求类型
					timeout: 10000, //超时时间设置为10秒；
					beforeSend: function() {
						infoWt = plus.nativeUI.showWaiting("拉取数据");
					},
					success: function(data) {
						//关闭加载动画
						infoWt.close();
						//服务器返回响应，根据响应结果，分析是否登录成功；
						if(data.json != null && data.json != "") {
							if(localStorage.getItem("headImg") != "" && localStorage.getItem("headImg") != null) {
								mui(".reg-img img")[0].src = localStorage.getItem("headImg");
							} else {
								if(data.json.User.useImg != "") {
									mui(".reg-img img")[0].src = myUrl + "Hunter/" + data.json.User.useImg;
								}
							}

							if(data.json.User.useNickname != "") {
								mui('#nickname')[0].innerText = data.json.User.useNickname;
							}

							if(data.json.User.useSign != "") {
								mui('#useSign')[0].innerText = data.json.User.useSign;
							}
						} else {
							plus.nativeUI.toast("个人信息数据拉取失败");
						}

					},
					error: function(xhr, type, errorThrown) {
						//关闭加载动画
						infoWt.close();
						plus.nativeUI.toast("网络异常");
					}
				});

			});
			//跳转设置页面
//			mui("#setting")[0].addEventListener("tap", function() {
//				
//				mui.openWindow({
//					url: "info/setting.html",
//					id: "info/setting.html",
//					show: {
//						aniShow: 'slide-in-right',
//						duration: 300
//					}
//				});
//				return;
//
//			});
		</script>
	</body>

</html>